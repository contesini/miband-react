(window["webpackJsonpmiband-react"]=window["webpackJsonpmiband-react"]||[]).push([[0],{114:function(e,t,n){},135:function(e,t){},137:function(e,t){},153:function(e,t,n){},155:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(10),i=n.n(c),o=n(11),s=n(22),u=n(85),p=n.n(u),d=n(86),l=n.n(d),h=n(87),b=n(43),g=(n(114),n(19)),m=n(12),f=n(20),v=n(21),O=n(24),E=function(e){return{type:"NAME_CHANGED",payload:e}},j=function(e){return{type:"ID_CHANGED",payload:e}},y=function(e){return{type:"HEARTH_BEAT_CHANGED",payload:e}},D=function(e){return{type:"MIBAND_CHANGED",payload:e}},N=function(e){return{type:"BLUETOOTH_CHANGED",payload:e}},k=function(e){return{type:"DEVICE_CHANGED",payload:e}},w=function(e){return{type:"TREINO_CHANGED",payload:e}},H=function(e){return{type:"LOADING_CHANGED",payload:e}},x=n(179),C=n(181),S=n(178),_=function(e){return!e.hidden&&e.children},T=n(17),A=n.n(T),L=n(31),B=n(8),G=n(182),I=n(38),P=n.n(I),M=function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(f.a)(this,Object(v.a)(t).call(this,e))).connectar=n.connectar.bind(Object(B.a)(n)),n}return Object(O.a)(t,e),Object(m.a)(t,[{key:"connectar",value:function(){var e=Object(L.a)(A.a.mark(function e(t){var n,a=this;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.changeLoading(!0),this.props.bluetooth){e.next=4;break}return t("WebBluetooth is not supported by your browser!"),e.abrupt("return");case 4:if(t("Requesting Bluetooth Device..."),this.props.device){e.next=11;break}return e.next=8,this.props.bluetooth.requestDevice({filters:[{services:[P.a.advertisementService]}],optionalServices:P.a.optionalServices});case 8:return n=e.sent,e.next=11,this.props.changeDevice(n);case 11:return n.addEventListener("gattserverdisconnected",Object(L.a)(A.a.mark(function e(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t("Device disconnected"),e.next=3,n.gatt.disconnect();case 3:a.props.enqueueSnackbar("Pulseira desconectada",{variant:"error"});case 4:case"end":return e.stop()}},e)}))),e.next=14,n.gatt.disconnect();case 14:this.props.changeLoading(!1);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(G.a,{variant:"contained",color:"primary",onClick:function(){return e.connectar(console.log)}},"Conectar")}}]),t}(r.a.Component),R=Object(s.b)(function(e){return{device:e.user.device,bluetooth:e.user.bluetooth}},function(e){return Object(o.b)({changeDevice:k,changeLoading:H},e)})(Object(b.withSnackbar)(M)),q=0,U=0,V=function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(f.a)(this,Object(v.a)(t).call(this,e))).startHrm=function(){var e=Object(L.a)(A.a.mark(function e(t){var c,i;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.changeLoading(!0),e.prev=1,e.next=4,n.props.changeTreinoStatus(!0);case 4:if(t("Connecting to the device..."),n.props.miband){e.next=21;break}return e.next=8,n.props.device.gatt.connect();case 8:return c=e.sent,t("Connected"),i=new P.a(c),e.next=13,i.init();case 13:return i.on("heart_rate",function(e){t("Heart Rate:",e),n.props.changeHearthBeat(e)}),i.on("button",function(){if(t("button tapped, count: ",q),q+=1,setTimeout(function(){return q=0},3e3),q>1){n.props.enqueueSnackbar("Usuario precisa de ajuda",{variant:"warning",action:function(e){return r.a.createElement(a.Fragment,null,r.a.createElement(G.a,{onClick:function(){n.props.closeSnackbar(e)}},"Fechar"))},autoHideDuration:null}),q=0}}),n.props.changeMiband(i),e.next=18,i.hrmStart();case 18:n.props.changeLoading(!1),e.next=24;break;case 21:return e.next=23,n.props.miband.hrmStart();case 23:n.props.changeLoading(!1);case 24:e.next=40;break;case 26:if(e.prev=26,e.t0=e.catch(1),t("Argh!",e.t0.message||e.t0),!(U>8)){e.next=37;break}return e.next=32,n.props.changeTreinoStatus(!1);case 32:n.props.enqueueSnackbar("Ocorreu um erro tente novamente",{variant:"error"}),U=0,n.props.changeLoading(!1),e.next=40;break;case 37:U+=1,t("Retrying ..."),n.startHrm(t);case 40:case"end":return e.stop()}},e,null,[[1,26]])}));return function(t){return e.apply(this,arguments)}}(),n.startHrm=n.startHrm.bind(Object(B.a)(n)),n}return Object(O.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(G.a,{variant:"contained",color:"primary",onClick:function(){return e.startHrm(console.log)}},"Iniciar Treino")}}]),t}(r.a.Component),X=Object(s.b)(function(e){return{device:e.user.device,miband:e.user.miband}},function(e){return Object(o.b)({changeHearthBeat:y,changeTreinoStatus:w,changeMiband:D,changeLoading:H},e)})(Object(b.withSnackbar)(V)),F=function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(f.a)(this,Object(v.a)(t).call(this,e))).endHrm=function(){var e=Object(L.a)(A.a.mark(function e(t){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.changeLoading(!0),t("end hrm"),e.prev=2,e.next=5,n.props.miband.hrmStop();case 5:return e.next=7,n.props.changeTreinoStatus(!1);case 7:return n.props.changeLoading(!1),e.next=10,n.props.changeMiband(null);case 10:e.next=17;break;case 12:return e.prev=12,e.t0=e.catch(2),e.next=16,n.props.changeTreinoStatus(!1);case 16:n.props.changeLoading(!1);case 17:t("disconnect device");case 18:case"end":return e.stop()}},e,null,[[2,12]])}));return function(t){return e.apply(this,arguments)}}(),n.endHrm=n.endHrm.bind(Object(B.a)(n)),n}return Object(O.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(G.a,{variant:"contained",color:"primary",onClick:function(){return e.endHrm(console.log)}},"Finalizar Treino")}}]),t}(r.a.Component),J=Object(s.b)(function(e){return{miband:e.user.miband}},function(e){return Object(o.b)({changeTreinoStatus:w,changeMiband:D,changeLoading:H},e)})(F),z=0,W=function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(f.a)(this,Object(v.a)(t).call(this,e))).notigicarPulseira=n.notigicarPulseira.bind(Object(B.a)(n)),n}return Object(O.a)(t,e),Object(m.a)(t,[{key:"notigicarPulseira",value:function(){var e=Object(L.a)(A.a.mark(function e(t){var n,a;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.changeLoading(!0),e.prev=1,e.next=4,this.props.device.gatt.connect();case 4:return n=e.sent,a=new P.a(n),this.props.changeMiband(a),e.next=9,a.init();case 9:a.showNotification("message"),this.props.changeLoading(!1),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),t("Error: "+e.t0.message||!1),z>4?this.props.changeLoading(!1):(z+=1,this.notigicarPulseira(t));case 17:case"end":return e.stop()}},e,this,[[1,13]])}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(G.a,{variant:"contained",color:"primary",onClick:function(){return e.notigicarPulseira(console.log)}},"Notificar Pulseira")}}]),t}(r.a.Component),K=Object(s.b)(function(e){return{device:e.user.device,miband:e.user.miband}},function(e){return Object(o.b)({changeMiband:D,changeLoading:H},e)})(W),Q=(n(153),function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(f.a)(this,Object(v.a)(t).call(this,e))).props.changeBluetooth(navigator.bluetooth),n.props.changeLoading(!1),n}return Object(O.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=window.location.search.split("?");return 2===e.length&&(this.props.changeId(e[1].split(":")[0]),this.props.changeName(e[1].split(":")[1])),r.a.createElement("div",{className:"App"},r.a.createElement(_,{hidden:!this.props.loading},r.a.createElement(S.a,null)),r.a.createElement(_,{hidden:this.props.loading},r.a.createElement(C.a,{justifyContent:"flex-start"},r.a.createElement(_,{hidden:!this.props.name},r.a.createElement("h1",null,this.props.name)),r.a.createElement("div",{className:"button-padding"},r.a.createElement(x.a,null,"favorite")," : ",r.a.createElement("strong",null,this.props.hearthBeat)),r.a.createElement(_,{hidden:null!==this.props.device},r.a.createElement("div",{className:"button-padding"},r.a.createElement(R,null))),r.a.createElement(_,{hidden:this.props.isTreinoStarted||null===this.props.device},r.a.createElement("div",{className:"button-padding"},r.a.createElement(X,null))),r.a.createElement(_,{hidden:!this.props.isTreinoStarted||null===this.props.device},r.a.createElement("div",{className:"button-padding"},r.a.createElement(J,null))),r.a.createElement(_,{hidden:null===this.props.device},r.a.createElement("div",{className:"button-padding"},r.a.createElement(K,null))))))}}]),t}(r.a.Component)),Y=Object(s.b)(function(e){return{id:e.user.id,name:e.user.name,hearthBeat:e.user.hearthBeat,device:e.user.device,isTreinoStarted:e.user.isTreinoStarted,loading:e.user.loading}},function(e){return Object(o.b)({changeBluetooth:N,changeName:E,changeId:j,changeLoading:H},e)})(Q),Z=n(6);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(n,!0).forEach(function(t){Object(Z.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var te={id:void 0,name:void 0,hearthBeat:0,bluetooth:null,device:null,miband:null,isTreinoStarted:!1,loading:!0},ne=Object(o.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ID_CHANGED":return ee({},e,{id:t.payload});case"NAME_CHANGED":return ee({},e,{name:t.payload});case"HEARTH_BEAT_CHANGED":return ee({},e,{hearthBeat:t.payload});case"MIBAND_CHANGED":return ee({},e,{miband:t.payload});case"BLUETOOTH_CHANGED":return ee({},e,{bluetooth:t.payload});case"DEVICE_CHANGED":return ee({},e,{device:t.payload});case"TREINO_CHANGED":return ee({},e,{isTreinoStarted:t.payload});case"LOADING_CHANGED":return ee({},e,{loading:t.payload});default:return ee({},e)}}}),ae=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),re=Object(o.a)(h.a,l.a,p.a)(o.d)(ne,ae);i.a.render(r.a.createElement(s.a,{store:re},r.a.createElement(b.SnackbarProvider,{maxSnack:3},r.a.createElement(Y,null))),document.getElementById("root"))},90:function(e,t,n){e.exports=n(155)}},[[90,1,2]]]);
//# sourceMappingURL=main.423bb9f0.chunk.js.map